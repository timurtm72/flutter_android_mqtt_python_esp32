# Flutter IoT Система Управления и Мониторинга

Мобильное приложение на Flutter для управления и мониторинга IoT системы на базе ESP32-S3. Приложение взаимодействует с MQTT брокером для управления RGB светодиодом и отображения данных с датчика температуры и влажности.

## Архитектура проекта

Проект построен с использованием чистой архитектуры Flutter и включает следующие основные компоненты:

### Экраны
- `LoginScreen` - экран авторизации с сохранением учетных данных
- `HomeScreen` - главный экран с двумя вкладками:
  - Управление RGB светодиодом
  - Мониторинг датчиков

### Сервисы
- `MqttService` - работа с MQTT протоколом:
  - Подключение к брокеру
  - Публикация команд управления RGB
  - Подписка на данные с датчиков
- `StorageService` - локальное хранение данных:
  - Сохранение учетных данных
  - Кэширование настроек RGB
  - Хранение последних показаний датчиков

### Модели данных
- `RgbData` - модель для RGB настроек
- `SensorData` - модель данных с датчиков

## Основные функции

### Управление RGB
- Выбор цвета через ColorPicker
- Регулировка яркости
- Предпросмотр выбранного цвета
- Сохранение настроек локально
- Отправка команд через MQTT

### Мониторинг датчиков
- Отображение текущей температуры и влажности
- Построение графиков за 24 часа
- Автоматическое обновление при получении новых данных
- Сохранение истории локально

## Технические особенности
- Использование `StreamController` для обработки MQTT сообщений
- Автоматическое переподключение к брокеру
- Локальное кэширование данных через `SharedPreferences`
- Визуализация данных с помощью `fl_chart`
- Выбор цвета через `flutter_colorpicker`
- Обработка JSON с помощью встроенных кодеков

## Потоки данных

### Исходящие
- Команды управления RGB через MQTT:
```json
{
  "r": 255,
  "g": 0,
  "b": 0,
  "brightness": 100
}
```

### Входящие
- Данные с датчиков через MQTT:
```json
{
  "temperature": 25.6,
  "humidity": 45.2
}
```

## Структура проекта
lib/
├── main.dart
├── home_screen.dart
├── login_screen.dart
├── models/
│ ├── rgb_data.dart
│ └── sensor_data.dart
└── services/
├── mqtt_service.dart
└── storage_service.dart

## Связанные проекты
- [Проект прошивки ESP32-S3](ссылка_на_проект_C)
- [Версия на Python](https://github.com/timurtm72/python_gui_mqtt_esp32)
- [Версия на Kotlin](https://github.com/timurtm72/kotlin_mqtt_esp32_python)

## Требования
- Flutter SDK
- Зависимости:
  - mqtt_client
  - shared_preferences
  - fl_chart
  - flutter_colorpicker

## Установка и запуск
1. Клонировать репозиторий
2. Установить зависимости: `flutter pub get`
3. Запустить приложение: `flutter run`
